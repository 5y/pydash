{% load i18n %}{% load staticfiles %}<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>{% block title %}PyDash{% endblock %}</title>
    <link href="{% static "css/fonts.css" %}" rel="stylesheet">
    <link href="{% static "css/font-awesome.css" %}" rel="stylesheet">
    <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet">
    <link href="{% static "css/bootstrap-responsive.min.css" %}" rel="stylesheet">
    <link href="{% static "css/dashboard.css" %}" rel="stylesheet">
    <link href="{% static "css/style.css" %}" rel="stylesheet">
    {% block style %}{% endblock %}
</head>
<body>
<div class="navbar navbar-fixed-top" style="">
    <div class="navbar-inner">
	<div class="container" id="refresh-home">
            <a class="brand" href="/">pyDash</a>
            <ul class="btn btn-mini">
                {% if request.user.is_authenticated or user.is_authenticated %}
                        <a href="{% url 'logout' %}">{% trans "Sign out" %}</a>
                {% else %}
                        <a href="{% url 'login' %}">{% trans "Sign in" %}</a>
                {% endif %}
            </ul>
            <div class="nav-collapse">
                        
	    </div>
        </div>
    </div>
</div>
<div class="subnavbar visible-desktop visible-tablet">
  <div class="subnavbar-inner">
      <div class="container">
        <ul class="mainnav">
            <li><a href="#refresh-os"><i class="icon-dashboard"></i><span>General</span> </a> </li>
            <li><a href="#refresh-df"><i class="icon-hdd"></i><span>Disk</span> </a> </li>
            <li><a href="#refresh-ps"><i class="icon-list-alt"></i><span>CPU</span> </a> </li>
            <li><a href="#refresh-ram"><i class="icon-list-alt"></i><span>RAM</span> </a> </li>
            <li><a href="#refresh-load"><i class="icon-bolt"></i><span>Load</span> </a> </li>
    	    <li><a href="#refresh-ispeed"><i class="icon-exchange"></i><span>Network</span> </a> </li>
    	    <li><a href="#refresh-home"><i class="icon-home"></i><span>Home</span> </a> </li>
	</ul>
      </div>
      <!-- /container --> 
    </div>
  <!-- /subnavbar-inner --> 
</div>
<div class="main">
  <div class="main-inner"> 
    <div class="container">
    {% block content %}
        
     <div class="row">
        
        <div class="span3">
         <div class="widget widget-table action-table">
            <div class="widget-header"> <i class="icon-info-sign"></i>
              <h3>General Info</h3>
              
              <div id="refresh-os">
              </div>
                
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
                <br>
              <div style="text-align:center;">
		<b>OS:</b> <span class=""></span>{{ getplatform }}<br>
              	<b>Uptime:</b> <span class="" id="os-uptime"></span> Hours<br>
              	<b>Hostname:</b> <span class=""></span>{{ gethostname }}<br>
		<b>CPU(s):</b> <span class=""></span>{{ getcpus.cpus }} x {{ getcpus.type }}
              	<br><br>
              </div>
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
        </div>
        
        <div class="span3">
         <div class="widget widget-table action-table">
            <div class="widget-header"> <i class="icon-info-sign"></i>
              <h3>CPU Usage %</h3>
              <div id="refresh-cpu">
                
              </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
        	<p></p>
                <canvas id="cpuuChart" width="250" height="230"></canvas>
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
        </div>
        
        <div class="span6">
         <div class="widget widget-nopad">
            <div class="widget-header">
                <i class="icon-list-alt"></i>
                <h3>Memory Usage</h3>
                <div id="refresh-ram">
                </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
              <div class="widget big-stats-container">
                <div class="widget-content">
                    <p></p>
                    <canvas id="memoryChart" width="700" height="200"></canvas>                                                     
                </div>
                <!-- /widget-content -->
                
              </div>
            </div>
          </div>
        </div>
        
     </div>
    
    <div class="row">
         <div class="span6">
           <div class="widget widget-table action-table">
            <div class="widget-header"> <i class="icon-hdd"></i>
              <h3>Disk Usage</h3>
              <div id="refresh-df">
              </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
		{% include 'disk.html' %}
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
         </div>
          <div class="span6">
            <div class="widget widget-table action-table">
            <div class="widget-header"> <i class="icon-bolt"></i>
              <h3>Load Average</h3>
              <div id="refresh-load">
              </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
                <p></p>
                <canvas id="loadChart" width="700" height="200"></canvas>
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
           
          </div>
        <!-- /span6 -->
       
         
        </div>
    <!-- /row -->
    
    
      <div class="row">
         <div class="span6">
           <div class="widget">
            <div class="widget-header"> <i class="icon-list"></i>
              <h3>Software</h3>
              <div id="refresh-whereis">
              </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
                
              <table id="whereis_dashboard" class="table table-hover table-condensed table-bordered" >
              
              </table>
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
         </div><!-- /span -->
         
         <div class="span3">
           <div class="widget widget-table action-table">
            <div class="widget-header"> <i class="icon-monitor"></i>
              <h3>IP</h3>
              <div id="refresh-ip">
              </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content" id="getip">
		{% include 'ip.html' %}
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
         </div><!-- /span -->
    
         <div class="span3">
           <div class="widget">
            <div class="widget-header"> <i class="icon-monitor"></i>
              <h3>Internet Speed</h3>
              <div id="refresh-ispeed">
              </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
                <div align="center" style="padding:10px;">
                    <span class="lead">{{gettraffic}}</span>
                </div>
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
         </div><!-- /span -->
         
	<!-- online users widget (breaks DOM pattern) -->
	<div class="span6 pull-right">
	<div class="widget widget-table action-table">
            <div class="widget-header"> <i class="icon-group"></i>
              <h3>Online</h3>
              <div id="refresh-online">
              </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
        	{% include 'users.html' %}    
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
	</div><!-- /span6 -->
      </div>
      <!-- /row -->

      <div class="row">
        <div class="span12">
          <div class="widget">
            <div class="widget-header"> <i class="icon-dashboard"></i>
              <h3> Processes </h3>
              <div id="refresh-ps">
              </div>
		<div class="pull-right">
                <input type="text" id="filter-ps" class="widget-search" placeholder="search..." />
              </div>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
                
              <table id="ps_dashboard" class="table table-hover table-condensed table-bordered" >
              </table>
            </div>
            <!-- /widget-content -->
          </div>
          <!-- /widget -->
        </div>
        <!-- /span -->
          
      </div>
      <!-- /row -->
      
      </div>
      
    </div>
    <!-- /container -->
  </div>
  <!-- /main-inner -->
</div>
<!-- /main -->	
     
{% endblock %}

{% block script %}
<script src="{% static "js/jquery.js" %}"></script>
<script src="{% static "js/base.js" %}"></script>
<script src="{% static "js/bootstrap.js" %}"></script>
<script src="{% static "js/jquery.dataTables.min.js" %}"></script>
<script src="{% static "js/Chart.min.js" %}"></script>
<script type="text/javascript">

function get_os_data(url, element) {
    $.get(url, function(data) {
            $(element).text(data);
                }, "json");
}

var dashboard = {};

dashboard.getOs = function() {
	get_os_data('/info/uptime/', "#os-uptime");
	}
dashboard.getUser = function() {
	get_os_data('/info/users/', "#os-users");
	}
	
var mem_ctx = $("#memoryChart").get(0).getContext("2d");
        var memChart = new Chart(mem_ctx);
        function memory_usage(){
            $.getJSON('/info/memory/{{ memusage }}', function(data) {
                var options = {
                    animation : false,
                    pointDotRadius : 2,
                    scaleLabel : "<%=value%> Mb"
                }
                memChart.Line(data, options);
            });
        }
        
	
var cpu_ctx = $("#cpuuChart").get(0).getContext("2d");
        var cpuChart = new Chart(cpu_ctx);
        function cpuu_usage(){
            $.getJSON('/info/cpuusage/{{ cpuusage }}', function(data) {
                var options = {
            	    percentageInnerCutout : 50,
            	    segmentStrokeWidth : 1
                }
                cpuChart.Doughnut(data, options);
            });
        }

var load_ctx = $("#loadChart").get(0).getContext("2d");
        var loadChart = new Chart(load_ctx);
        function load_average(){
            $.getJSON('/info/loadaverage/{{ loadaverage }}', function(data) {
                var options = {
                    animation : false,
                    pointDotRadius : 2,
                    scaleLabel : "<%=value%>"
                }
                loadChart.Line(data, options);
            });
        }

        $(function() {
            window.setInterval('memory_usage()', {{ time_refresh }});
            window.setInterval('load_average()', {{ time_refresh }});
            window.setInterval('dashboard.getOs()', {{ time_refresh }});
            window.setInterval('cpuu_usage()', {{ time_refresh }});
        });
        
</script>
{% endblock %}

</body>
</html>
